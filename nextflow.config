import java.time.*
Date now = new Date()

process {
    errorStrategy = 'finish'
    withName: trimmomatic {
        container = 'docker://staphb/trimmomatic:0.39'
    }
    withName: seqpurge {
        conda = 'bioconda::ngs-bits=2019_09'
    }
    withName: kraken {
        container = 'docker://staphb/kraken2:2.1.2-no-db'
    }
    withName: filterreads {
        conda = 'bioconda::krakentools=1.2'
    }
    withName: kraken2krona {
        conda = 'bioconda::krakentools=1.2'
    }
    withName: krona {
        conda = 'bioconda::krona=2.8'
    }
    withName: ray {
        container = 'library://millironx/default/ray:v2.3.1'
        errorStrategy = 'ignore'
    }
    withName: iva {
        container = 'docker://sangerpathogens/iva:1.0.11'
        errorStrategy = 'ignore'
    }
    withName: a5 {
        container = 'https://depot.galaxyproject.org/singularity/a5-miseq:20160825--hdfd78af_2'
        errorStrategy = 'ignore'
    }
    withName: blast {
        container = 'docker://ncbi/blast:2.11.0'
    }
    withName: unzipreads {
        container = 'library://millironx/default/pigz:2.4-4'
    }
    withName: bwa {
        container = 'docker://staphb/bwa:0.7.17'
    }
}
singularity {
    enabled = true
}
params {
    tracedir = "pipeline_info"
    timestamp = now.format("yyyyMMdd-HH-mm-ss")
}
timeline {
    enabled = true
    file = "${params.tracedir}/${params.timestamp}_timeline.html"
}
report {
    enabled = true
    file = "${params.tracedir}/${params.timestamp}_report.html"
}
trace {
    enabled = true
    file = "${params.tracedir}/${params.timestamp}_trace.txt"
}
dag {
    enabled = true
    file = "${params.tracedir}/${params.timestamp}_dag.svg"
}
